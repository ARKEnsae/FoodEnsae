<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<style>body{background-color:white;}</style>
<script src="r2d3_libs/htmlwidgets/htmlwidgets.js"></script>
<script src="r2d3_libs/r2d3-render/r2d3-render.js"></script>
<script src="r2d3_libs/webcomponents/webcomponents.js"></script>
<script src="r2d3_libs/r2d3-binding/r2d3.js"></script>
<script src="r2d3_libs/pymjs/pym.v1.min.js"></script>
<script src="r2d3_libs/d3v6/d3.min.js"></script>
  <title>r2d3</title>
</head>
<body>
<div id="htmlwidget_container">
  <div id="htmlwidget-6ea631efd28d063db2bc" style="width:100%;height:300px;" class="r2d3 html-widget"></div>
  <script>HTMLWidgets.pymChild = new pym.Child();HTMLWidgets.addPostRenderHandler(function(){
                                setTimeout(function(){HTMLWidgets.pymChild.sendHeight();},100);
                            });</script>
</div>
<script type="application/json" data-for="htmlwidget-6ea631efd28d063db2bc">{"x":{"data":{"Country":[1,2,3,4],"Value":[62994,11324,121972,392113],"color":["#FCBBA1","#FB6A4A","#CB181D","#67000D"],"titre":["Nombre de produits selon le groupe Nova","Nombre de produits selon le groupe Nova","Nombre de produits selon le groupe Nova","Nombre de produits selon le groupe Nova"],"borne_max":[400000,400000,400000,400000]},"type":"data.frame","container":"div","options":null,"script":"var d3Script = function(d3, r2d3, data, div, width, height, options, theme, console) {\nthis.d3 = d3;\n\ndiv = d3.select(div.node());\n/* R2D3 Source File:  data/lollichart.js */\n\nconst df = data;\n\n\n// set the dimensions and margins of the graph\nvar margin = {top: 10, right: 30, bottom: 60, left: 100},\n    width = 460 - margin.left - margin.right,\n    height = 300 - margin.top - margin.bottom;\n\n// Margins etc\n\nvar svg = div\n//var svg = d3.select(\"#my_dataviz\")\n  .append(\"svg\")\n   .attr(\"width\", width + margin.left + margin.right)\n    .attr(\"height\", height + margin.top + margin.bottom)\n  .append(\"g\")\n    .attr(\"transform\",\n          \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n// Parse the Data\n//d3.csv(\"https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/7_OneCatOneNum_header.csv\", function(data) {\n\n// sort data\n//data.sort(function(b, a) {\n//  return a.Value - b.Value;\n//});\n\n//https://www.d3-graph-gallery.com/graph/basic_datamanipulation.html\nconst borne = d3.max(df.map(function(d) { return d.borne_max; }));\n//const borne = df.map(function(d) { return (d.borne_max)[0]; });\n\n// Add X axis\nvar x = d3.scaleLinear()\n  .domain([0, borne])\n  .range([ 0, width]);\nsvg.append(\"g\")\n  .attr(\"transform\", \"translate(0,\" + height + \")\")\n  .call(d3.axisBottom(x))\n  .selectAll(\"text\")\n    .attr(\"transform\", \"translate(-10,0)rotate(-45)\")\n    .style(\"text-anchor\", \"end\");\n\n// Y axis\nvar y = d3.scaleBand()\n  .range([ 0, height ])\n  .domain(df.map(function(d) { return d.Country; }))\n  //.domain([\"A\",\"B\",\"C\",\"D\",\"E\"])\n  .padding(1);\n\n\n  \n  //.attr('strock-width',0)\nsvg.append(\"g\")\n  //.call(d3.axisLeft(y))\n  \n\n\n// X axis title\nsvg.selectAll(\"xtitle\")\n  .data(df)\n  .enter()\n  .append(\"text\")\n    .text(function(d) { return d.titre; })\n    .attr(\"text-anchor\", \"end\")\n    .attr(\"x\", width)\n    .attr(\"y\", height + margin.top + 45)\n    .attr(\"font-family\" , \"sans-serif\")\n    .attr(\"font-size\" , \"12px\")\n    \n    \n \n\n\n\n    \n  \n\nfunction transition() { \n\n   var timeLine = svg.selectAll(\"myline\")\n   .data(df)\n    .enter()\n  .append(\"line\")\n  .attr(\"stroke-width\", 8)\n    .attr(\"x1\", x(0))\n    .attr(\"x2\", x(0))\n    .attr(\"y1\", function(d) { return y(d.Country); })\n    .attr(\"y2\", function(d) { return y(d.Country); })\n    .attr(\"stroke\", function(d) { return d.color; })\n\n  var timeCircle = svg.selectAll(\"mycircle\")\n    .data(df)\n    .enter()\n    .append(\"circle\")\n      .attr(\"cx\", x(0) )\n      .attr(\"cy\", function(d) { return y(d.Country); })\n      .attr(\"r\", \"15\")\n      .style(\"fill\", function(d) { return d.color; })\n      \n    // InnerCircles -> start at X=0\n   var timeInnerCircle = svg.selectAll(\"myinnercircle\")\n    .data(df)\n    .enter()\n    .append(\"circle\")\n    .attr(\"cx\", x(0) )\n    .attr(\"cy\", function(d) { return y(d.Country); })\n    .attr(\"r\", \"10\")\n    .style(\"fill\", \"white\")\n\n      var timeLabel = svg.selectAll(\"mylabel\")\n      .data(df)\n      .enter()\n      .append(\"text\")\n      .text(function(d){return d.Country;})\n      .attr(\"x\", x(0) )\n      .attr(\"y\", function(d) { return y(d.Country)+5; })\n    //.attr(\"font-family\" , \"Saira\")\n    .attr(\"font-size\" , \"14px\")\n    .attr(\"font-weight\" , 1000)\n    .attr(\"fill\" , function(d){return d.color})\n    .attr(\"text-anchor\", \"middle\")\n    \n \n  \n    repeat();\n    \n    function repeat() {\n      \n// Change the X coordinates of line and circle\n      timeLine\n      .transition()\n      .duration(1000)\n      .attr(\"x1\", function(d) { return x(d.Value); })\n      .transition()\n      .duration(5000)\n      .transition()\n      .duration(0)\n      .attr(\"x1\", function(d) { return x(0); })\n       .on(\"end\", repeat);  // when the transition finishes start again\n      \n      \n      // Change the X coordinates of line and circle\n      timeCircle\n      .transition()\n      .duration(1000)\n      .attr(\"cx\", function(d) { return x(d.Value); })\n      .transition()\n      .duration(5000)\n      .transition()\n      .duration(0)\n      .attr(\"cx\", function(d) { return x(0); })\n      .on(\"end\", repeat);  // when the transition finishes start again\n\n      timeInnerCircle\n      .transition()\n      .duration(1000)\n      .attr(\"cx\", function(d) { return x(d.Value); })\n      .transition()\n      .duration(5000)\n      .transition()\n      .duration(0)\n      .attr(\"cx\", function(d) { return x(0); })\n      .on(\"end\", repeat);  // when the transition finishes start again\n\n\n      timeLabel\n      .transition()\n    .duration(1000)\n    .attr(\"x\", function(d) { return x(d.Value)-1; })\n    .transition()\n      .duration(5000)\n      .transition()\n      .duration(0)\n      .attr(\"x\", function(d) { return x(0); })\n\n\n\n    };\n\n};\n\ntransition();\n\n};","style":null,"version":6,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
<script type="application/htmlwidget-sizing" data-for="htmlwidget-6ea631efd28d063db2bc">{"viewer":{"width":"100%","height":300,"padding":0,"fill":false},"browser":{"width":"100%","height":300,"padding":0,"fill":false}}</script>
</body>
</html>
